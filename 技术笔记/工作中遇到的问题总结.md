1. 尽量少修改公共的东西，做判断的话在自己写需求的地方加判断
2. 如果能从数据层面解决问题就不要增加不必要的代码
3. 虚环境：可以在本地或者测试环境上，将请求代理到swagger上边，这样的话就可以使用swagger的mock数据了，swagger里边的调试那里可以测试请求，那边的数据可以拿过来mock用
4. 虚环境的添加：
    1.  在页面对应的template里边添加一个js

            ```
            <% if (process.env.VUE_APP_CONFIG === 'test' || process.env.VUE_APP_CONFIG === 'dev') {
            %>
            <script src="https://xyks.yuanfudao.biz/h5/venv-tools/venv-tools-0.0.3.js"></script>
            <% } %>
            ```
        需要注意的是，if的判断条件，不同项目里边关于test和dev的定义可能是不一样的，这次碰到的是，vue-cli3的项目里边是上边这种，vue-cli2里边是process.env.NODE_ENV === 'production'，process.env.NODE_ENV === 'development'

5. 刘海屏与安全区
6. VIP专区页，试卷还原模块，点金更多触发两次页面，原因是因为在模块整体加了一个跳转来实现点击模块任意位置都可以跳转，然后在更多那边也有一个点击事件是跳转，所以当点击更多时，会触发两次
    1.  解决方法：阻止更多那边的click事件的冒泡，@click.stop
7. 考虑各种页面跳入同一个页面，这个页面back按钮的，function情况，是closeWebview还是go(-1)
8. border-radius 与 overflow的问题
    1.  父元素设置了barder-radius，子元素有可能会把父元素的圆角盖住
    2.  可以通过给父元素设置overflow:hidden解决
9. 我们隐藏了webview自带的bar，手机的返回按钮调取的是我们传给客户端的trigger的方法，可以通过WebView来进行设置

        ```
        WebView.setLeftButton({
            trigger: () => {
                .....leftButton的function.....
            }
        })
        ```

10. 写代码的时候要考虑性能优化，减少发送请求，在购买混入那边，将请求客户端的桥方法放在了混入的mounted里边，混入在selector里边与VipPurchase里用了两次，所以mounted了两次，那个请求也就发了两次
11. **另外一个性能问题：让数据请求的时机更早一点，例子**
     1.   和问题107一起看，我的写法是在购买成功后，调取store里边的方法，这里需要await客户端的桥方法，如果客户端的方法很慢的话，会影响用户体验
     2.   文静的方法是；store里边的function，返回一个promise，然后进入VipPurchase页面的monted时，就调用这个方法，它返回一个promise，然后在购买成功时，await这个promise，这样的话请求时机就从购买成功才调用客户端的桥方法变成了，进入这个页面就调用客户端的桥方法。
12. SKU是标准化产品单元，区分品种；SKU是库存量单位，区分单品；商品特指与商家有关的商品，可对应多个SKU。首先，搞清楚商品与单品的区别。例如，iphone是一个单品，但是在淘宝上当很多商家同时出售这个产品的时候，iphone就是一个商品了。
13. 点击bottombutton时，有可能图片没有渲染完成，设置了一个disable变量，如果图片没有渲染完成，就不让点击这个button
14. new Date在ios上返回 invalid Date，在ios里不支持 '-' 连接的日期，所以为了兼容ios，将日期转换为 '/' 连接的。
     1.   var d = new Date("2017-08-11 12:00:00".replace(/-/g, "/"));
15.  做的优化，以及用户体验的考虑，组件的抽离与设计
16.  更换短链其实就是使用302和相应头的location进行一个重定向
17.  弹窗显示禁止滚动，其实就是Watch控制弹窗显示的变量，当newVal为true时，给body添加overflow = hidden,position = fixed，当newVal为false时，overflow = auto，position = relative
18.  发请求的地方最好都用try catch包一下
19.  埋点的抽离

    ```
    @Watch('isVisible')
    isVisibleChange (val: boolean) {
        let finishType = this.success ? 1 : 2
        let frogMethod = val ? this.$addEventFrog : this.$addClickFrog
        if(this.isApp) {
            let appFrogUrl = val ? 'promotion/finishPop' : 'promotion/finishPop/close'
            try {
            frogMethod(appFrogUrl, {
                keyfrom: this.keyfrom,
                activityTag: 'promotion2021',
                VIPType: this.VIPType,
                userPeriod: this.doubleElevenInfo.status,
                finishType
            })
            } catch (err) {
            console.log('>>>', 'err', err)
            }
        } else {
            let appFrogUrl = val ? 'finishPop' : 'finishPop/close'
            try {
            frogMethod(appFrogUrl, {
                shareuserId: this.shareUserId,
                userId: this.ytkUserId,
                finishType
            })
            } catch (err) {
            console.log('>>>', 'err', err)
            }
        }
    }
    ```
    1. 分位端内和端外的支付弹窗，因为成功和失败只有url和finishType不同，所以提取出来，根据状态赋予不同的值
    2. 成功和失败调用的方法不同，一个是event一个是click
       1. 最开始使用的方法

            ```
            let frogMethod = val ? '$addEventFrog' : '$addClickFrog'
            this[frogMethod]
            报错
            ```
            说this上找不到frogMethod这个属性，直接使用this['$addClickFrog']是可以的，没法解决

        1. 后来使用的是上述代码中的方法
20. 访问官网的域名，然后到对应ngix上，通过ngix配置的路由跳转到对应的服务器来获取数据
21. ossutil的工作原理：下载ossutil，配置对应的config，然后使用ossutilmac64 cp来将dist文件夹下的文件复制到对应的服务器的path上去，-r 是递归的意思，-f 是force的意思
22. [npm 发布包](https://juejin.cn/post/6844904112153165832)：在发布包之前，首先去npm市场去搜以下有没有重名，如果有重名是会发布失败的。
23. 分支插件学习
    1. 分支插件中，rollup.config.js它配置了整个项目的打包流程，入口是src/init.js，将项目打包完成后生成了bulid/init.js，package.json配置了整个npm库的信息，入口是main字段对应的，index.js，该文件里边引用了build/init.js里的代码，完成闭环
    2. [process.argv](http://nodejs.cn/api/process/process_argv.html)
    3. [minimist](https://juejin.cn/post/6975687741761650695)
       1. minimist()这个方法对应可以传两个参数，minimist(args, opts={})。

            ```
            const minimist = require('minimist');
            let argv = minimist(args, opts={})
            ```

          1. args，需要解析的数组，必填
          2. opts，额外传给minimist的参数选项，可选
          3. argv._输出一个数组，包含我们的命令参数。

    4. 在部署我们自己的分支的时候，需要加上branch/mybranch，这是因为在ngix配置如下

            ```
            location ~ ^/h5/([^/]*)/branch/(.*) {
                proxy_pass https://static-nginx-test.oss-cn-beijing.aliyuncs.com/leo/h5/$1/$2;
            }

            location ~ ^/h5/([^/]*)/(.*) {
                proxy_pass https://static-nginx-test.oss-cn-beijing.aliyuncs.com/leo/h5/$1/master/$2;
            }
            ```
        如果我们不带branch时，服务器会默认代理到master分支，如果添加了其他路径，就需要加上branch，否则就会404
    5. npm publish，需要该npm库的owner添加一下我的账户，我才能publish
    6. 判断HtmlWebpackPlugin的原因是因为项目里边使用了template.html，如果没有这个插件就无法使用模板，所以才进行了判断，另外一个if是兜底方案，在目前的项目里边几乎不会走到那个if里边
24. 周报不能返回的问题，leo-web-page
    1.  问题1：
        1.  原因：最开始定位到的是this.detail.title为null，导致Base64.ecode报错
        2.  解决办法：给title添加'default'默认值
    2.  问题2：
        1.  原因：上边的问题排查完毕后，解决了一部分问题，仍然有机型有问题
        2.  解决办法：经排查，是Storage.setItem(key, 1)里边1使用了number，在setItem方法里边对1进行了Base64的encode报错了，所以导致退出失败
        3.  原因分析：应该是在某次上线当中更新了Base64的版本，老版本支持null和number类型，新版本不支持了，才报错
    3.  排查方法：
        1.  console
        2.  debugger
        3.  source-map
        4.  删除代码的方式来定位到某一行（尽量别用）
    4.  排查思路：最开始console里边没有报错，source-map里边也没有走到catch方法里边，但是通过定位发现在往localStorage写入时，写入失败，所以往前排查，看在写入之前做了什么操作，发现进行了Base64.encode转换，所以测试直接写入一个string能否成功，成功了，就判断是encode的问题，然后去看对应的库，观察是否限制了输入的类型，后来改成string类型后，问题解决
25. 测试环境中用debugger不生效
    1.  原因：在vue的配置文件中NODE_ENV的值为production，应该是在production中默认去掉了debugger，所以不生效
    2.  解决办法：改成test
26. 配置ab实验，abTest
    1.  去switch平台上配置对应的实验，然后请求接口，由平台那边根据它的代码计算一个结果出来，判断该用户是否命中实验
    2.  最简单的计算算法，比如对用户的ID取模
27. 特权页小三角的问题
    1.  最开始问题卡在了使用伪元素生成的小三角，如图，当向下移动该三角时，会因为三角超出icon限制无法显示，这是因为icon距离下方detail的距离是由图片的marginTop生成的，那部分属于图片所以无法控制那部分
    2. 解决方法：取消detail图片的marginTop，然后icon和图片之间的距离由伪元素的大小来撑开

        ![小三角bug](../img/小三角bug-1.png)
        ![小三角bug](../img/小三角bug-2.png)

28. app调起微信
    1.  Android

            ```
            webview.openSchema({
                schemas: ['weixin://'],
                trigger: (err) => {
                    console.log(err)
                }
            });
            ```

    2.  IOS： window.location.href = 'weixin://';

29. console平台部署新项目
    1.  [使用node脚手架创建新项目](https://api-test.checkmath.net/leo/h5/checkmath-web-doc/pages/documents/results/node/cli.html)(弄懂脚手架做了什么)
    2.  新建完成之后，会有一个review，是整个项目的初始化，需要+2，否则gerrit项目上就没有master分支
    3.  去console上边点击新建项目（研究一下console做了什么，配置的东西有什么用）
        1.  选择js，静态，无模板
        2.  输入名字，选择优先级
        3.  因为在gerrit创建过项目了，所以第四个会显示初始化失败，没有问题的
    4.  进入项目，选择流水线
        1.  流水线设置，设置online，取消test( 测试线)
        2.  服务管理-服务列表里边，配置对应的OSS Bucket和OSS Path